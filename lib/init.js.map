{"version":3,"sources":["../src/init.js"],"names":[],"mappings":";;;;;QAGgB,MAAM,GAAN,MAAM;QAON,YAAY,GAAZ,YAAY;QASZ,cAAc,GAAd,cAAc;kBAKN,IAAI;;;;IAxBhB,OAAO;;;;;;;;;;AAGZ,SAAS,MAAM,GAA2B;MAA1B,SAAS,yDAAG,KAAK;MAAE,KAAK;;AAC7C,MAAI,SAAS,EAAE;AACb,WAAO,KAAK,CAAC,QAAQ,EAAE,CAAC,MAAM,CAAC,GAAG,CAAA;GACnC;AACD,SAAO,MAAM,CAAC,QAAQ,CAAC,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAA;CACzD;;AAEM,SAAS,YAAY,CAAC,KAAK,EAAE,KAAK,EAAE;AACzC,MAAM,KAAK,GAAG,KAAK,CAAC,QAAQ,EAAE,CAAA;AAC9B,MAAM,OAAO,GAAG,KAAK,CAAC,MAAM,CAAC,wBAAwB,CAAA;AACrD,MAAI,KAAK,CAAC,MAAM,CAAC,iBAAiB,IAAI,OAAO,IAAI,OAAO,CAAC,MAAM,GAAG,CAAC,EAAE;AACnE,SAAK,CAAC,WAAW,GAAG,OAAO,CAAA;AAC3B,WAAO,OAAO,CAAA;GACf;CACF;;AAEM,SAAS,cAAc,CAAC,KAAK,EAAE;AACpC,MAAM,GAAG,GAAG,MAAM,EAAE,CAAA;AACpB,OAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,CAAC,EAAC,GAAG,EAAH,GAAG,EAAE,MAAM,EAAE,UAAU,EAAC,CAAC,CAAC,CAAA;CAC9D;;AAEc,SAAS,IAAI,CAAC,KAAK,EAAE;AAClC,MAAM,GAAG,GAAG,MAAM,EAAE,CAAA;AACpB,OAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAU,CAAC,EAAC,GAAG,EAAH,GAAG,EAAE,MAAM,EAAE,MAAM,EAAC,CAAC,CAAC,CAAA;;AAEzD,QAAM,CAAC,cAAc,GAAG,qBAAM,YAAY,CAAC,CAAC,KAAK,CAAC,CAAA;AAClD,QAAM,CAAC,UAAU,GAAG,qBAAM,cAAc,CAAC,CAAC,KAAK,CAAC,CAAA;CACjD","file":"init.js","sourcesContent":["import * as actions from './actions'\nimport curry from 'curry'\n\nexport function getUrl(universal = false, store) {\n  if (universal) {\n    return store.getState().router.url\n  }\n  return window.location.pathname + window.location.search\n}\n\nexport function handleUnload(store, event) {\n  const state = store.getState()\n  const message = state.router.preventNavigationMessage\n  if (state.router.preventNavigation && message && message.length > 0) {\n    event.returnValue = message\n    return message\n  }\n}\n\nexport function handlePopState(store) {\n  const url = getUrl()\n  store.dispatch(actions.urlChanged({url, source: 'popState'}))\n}\n\nexport default function init(store) {\n  const url = getUrl()\n  store.dispatch(actions.urlChanged({url, source: 'init'}))\n\n  window.onbeforeunload = curry(handleUnload)(store)\n  window.onpopstate = curry(handlePopState)(store)\n}\n"]}